MAT
solve(MAT)%*%(X-NU)
solve(MAT)*(X-NU)
solve(MAT)%*%(X-NU)
solve(MAT)%*%t(X-NU)
solve(MAT)%*%(X-NU)
sum(solve(MAT)%*%(X-NU))
MAT[1,2]=MAT[2,1]=0.1*sqrt(V[1]*V[2])
MAT
sum(solve(MAT)%*%(X-NU))
sum(solve(MAT)%*%(X-NU))
X
NU
MAT
sqrt(solve(MAT))
(solve(MAT^0.5)
)
solve(MAT^0.5)
solve(MAT^0.5)%*%X
sum(solve(MAT^0.5)%*%X)
sum(solve(MAT^0.5)%*%X)/track(MAT)
sum(solve(MAT^0.5)%*%X)/tk(MAT)
sum(solve(MAT^0.5)%*%X)/tc(MAT)
sum(solve(MAT^0.5)%*%X)/trace(MAT)
sum(solve(MAT^0.5)%*%X)/sum(trace(MAT))
sum(solve(MAT^0.5)%*%X)/trace(MAT)
trace(MAT)
MAT
X=c(0.1,0.2)
SE=c(0.001,0.1)
V=SE^2
W=1/V
NU=sum(X*W)/(sum(W))
NU
S=array(0,c(2,2))
as.matrix(S)
diag(S)=V
sum(solve(S)%*%(X-NU))
S[1,2]=S[2,1]=0.1*sqrt(V[1]*V[2])
sum(solve(S)%*%(X-NU))
solve(S)%*%(X-NU)
S[1,2]=S[2,1]=1*sqrt(V[1]*V[2])
solve(S)%*%(X-NU)
S
solve(S)
det(S)
solve(S)%*%(X-NU)
S[1,2]=S[2,1]=0.5*sqrt(V[1]*V[2])
solve(S)%*%(X-NU)
solve(S)*(X-NU)
S=array(0,c(2,2))
as.matrix(S)
diag(S)=V
solve(S)*(X-NU)
solve(S)%o%(X-NU)
solve(S)%*%(X-NU)
sum(solve(S)%*%(X-NU))
solve(S)%*%(X-NU)
sum(solve(S)%*%(X-NU))
W=solve(S)
W
V
W
V=SE^2
W=1/V
W
W=solve(S)
W%*%X
(W%*%X)/sum(W)
sum((W%*%X))/sum(W)
W=solve(S)
sum((W%*%X))/sum(W)
S[1,2]=S[2,1]=0.5*sqrt(V[1]*V[2])
W=solve(S)
sum((W%*%X))/sum(W)
W=solve(S)
sum((W%*%X))/sum(W)
NU=sum((W%*%X))/sum(W)
sum(solve(S)%*%(X-NU))
NU
X
sum(solve(S)%*%(X-NU))
W=solve(S)
NU=sum((W%*%X))/sum(W)
W
W=solve(S)
NU=sum((W%*%X))/sum(diag(W))
NU
W=solve(S)
NU=sum((W%*%X))/sum((W))
sum(solve(S)%*%(X-NU))
solve(S)%*%(X-NU)
X-NU
X
NU
S
X=c(0.1,0.2)
SE=c(0.001,0.2)
V=SE^2
W=1/V
NU=sum(X*W)/(sum(W))
NU
S=array(0,c(2,2))
as.matrix(S)
diag(S)=V
sum(solve(S)%*%(X-NU))
W=solve(S)
sum((W%*%X))/sum(W)
S[1,2]=S[2,1]=0.5*sqrt(V[1]*V[2])
W=solve(S)
NU=sum((W%*%X))/sum((W))
solve(S)%*%(X-NU)
NU
W
solve(S)%*%(X-NU)
solve(S)%*%(X-NU)
S
S
X=c(0.1,0.2)
SE=c(0.001,0.02)
V=SE^2
W=1/V
NU=sum(X*W)/(sum(W))
NU
S=array(0,c(2,2))
as.matrix(S)
diag(S)=V
sum(solve(S)%*%(X-NU))
NU
X=c(0.1,0.2)
SE=c(0.001,0.002)
V=SE^2
W=1/V
NU=sum(X*W)/(sum(W))
NU
S=array(0,c(2,2))
as.matrix(S)
diag(S)=V
sum(solve(S)%*%(X-NU))
W=solve(S)
sum((W%*%X))/sum(W)
S[1,2]=S[2,1]=0.5*sqrt(V[1]*V[2])
W=solve(S)
NU=sum((W%*%X))/sum((W))
solve(S)%*%(X-NU)
NU
S
det(S)
solve(S)%*%(X-NU)
W=solve(S)
NU=sum((W%*%X))/sum((W))
solve(S)%*%(X-NU)
NU
sqrt(V[1]*V[2])
V
W=solve(S)
NU=sum((W%*%X))/sum((W))
W
NU
X=c(0.1,0.2)
SE=c(0.001,0.001)
V=SE^2
W=1/V
NU=sum(X*W)/(sum(W))
NU
S=array(0,c(2,2))
as.matrix(S)
diag(S)=V
sum(solve(S)%*%(X-NU))
W=solve(S)
sum((W%*%X))/sum(W)
S[1,2]=S[2,1]=0.5*sqrt(V[1]*V[2])
W=solve(S)
NU=sum((W%*%X))/sum((W))
solve(S)%*%(X-NU)
NU
W
W=solve(S)
NU=sum((W%*%X))/sum((W))
NU
solve(S)%*%(X-NU)
sum(solve(S)%*%(X-NU))
X=c(0.1,0.2)
SE=c(0.001,0.01)
V=SE^2
W=1/V
NU=sum(X*W)/(sum(W))
NU
S=array(0,c(2,2))
as.matrix(S)
diag(S)=V
sum(solve(S)%*%(X-NU))
W=solve(S)
sum((W%*%X))/sum(W)
S[1,2]=S[2,1]=0.5*sqrt(V[1]*V[2])
W=solve(S)
NU=sum((W%*%X))/sum((W))
NU
sum(solve(S)%*%(X-NU))
V=SE^2
W=1/V
NU=sum(X*W)/(sum(W))
NU
sum(solve(S)%*%(X-NU))
S[1,2]=S[2,1]=-0.5*sqrt(V[1]*V[2])
W=solve(S)
NU=sum((W%*%X))/sum((W))
NU
sum(solve(S)%*%(X-NU))
g=rbind(100000,0:2,0.5)
g
g=rbinom(100000,0:2,0.5)
g
g=rbinom(100000,0:2,0.5)
y1=rnorm(100000)+g*0.1
summary(y1)
g=rbinom(100000,0:2,0.5)
y1=rnorm(100000)+g*0.1
y=rep(0,100000)
y[y1>0.6]=1
table(g)
table(y)
ysd=y/sd(y)
lm(y~ysd)
summary(lm(y~ysd))
g=rbinom(100000,0:2,0.5)
y1=rnorm(100000)+g*0.01
y=rep(0,100000)
y[y1>0.6]=1
table(g)
table(y)
ysd=y/sd(y)
lm(y~ysd)
summary(lm(ysd~g))
g=rbinom(100000,0:2,0.5)
y1=rnorm(100000)+g*0.05
y=rep(0,100000)
y[y1>0.6]=1
table(g)
table(y)
ysd=y/sd(y)
summary(lm(ysd~g))
l=summary(lm(ysd~g))
l
se=l$coefficients[2,2]
se
prev=sum(y==1)/length(y)
prev
sqrt(1/(var(g)*N))
se
N
sqrt(1/(var(g)*length(y)))
se=l$coefficients[2,2]
sqrt(1/(var(g)*length(y)))
se
se=l$coefficients[2,2]
se1=sqrt(1/(var(g)*length(y)))
se
se1
summ,ary(glm(y~g))
summary(glm(y~g))
lg=summary(glm(y~g))
seg=lg$coef[2,2]
seg
se/(prev*(1-prev))
lg=summary(glm(y~g,family = "binomial"))
seg=lg$coef[2,2]
seg
se/(prev*(1-prev))
lg
table(y)
se/(2*prev*(1-prev))
se/(prev*(1-prev))
se1/(prev*(1-prev))
seg
se/sqrt((prev*(1-prev)))
seg
se/sqrt((prev*(1-prev)))
sqrt(1/(var(g)*length(y)*sqrt((prev*(1-prev))))
sqrt(1/(var(g)*length(y)*sqrt((prev*(1-prev)))))
sqrt(1/(var(g)*length(y)*sqrt((prev*(1-prev)))))
sqrt(1/(var(g)*length(y)*(prev*(1-prev))))
se/sqrt((prev*(1-prev)))
se1/sqrt((prev*(1-prev)))
se1/sqrt((prev*(1-prev)))
seg=lg$coef[2,2]
seg
se/sqrt((prev*(1-prev)))
sqrt(1/(var(g)*length(y)*(prev*(1-prev))))
seg=lg$coef[2,2]
seg
se/sqrt((prev*(1-prev)))
SE=sqrt(1/(var(g)*length(y)*(prev*(1-prev))))
SE
g=rbinom(100000,0:2,0.5)
y1=rnorm(100000)+g*0
y=rep(0,100000)
y[y1>0.6]=1
table(g)
table(y)
prev=sum(y==1)/length(y)
ysd=y/sd(y)
l=summary(lm(ysd~g))
l
se=l$coefficients[2,2]
se1=sqrt(1/(var(g)*length(y)))
se
se1
lg=summary(glm(y~g,family = "binomial"))
seg=lg$coef[2,2]
seg
se/sqrt((prev*(1-prev)))
SE=sqrt(1/(var(g)*length(y)*(prev*(1-prev))))
SE
g=rbinom(100000,0:2,0.5)
y1=rnorm(100000)+g*0.1
y=rep(0,100000)
y[y1>0.6]=1
table(g)
table(y)
prev=sum(y==1)/length(y)
ysd=y/sd(y)
l=summary(lm(ysd~g))
l
se=l$coefficients[2,2]
se1=sqrt(1/(var(g)*length(y)))
se
se1
lg=summary(glm(y~g,family = "binomial"))
seg=lg$coef[2,2]
seg
se/sqrt((prev*(1-prev)))
SE=sqrt(1/(var(g)*length(y)*(prev*(1-prev))))
SE
setwd("~/Projects/Sanger_OT_GoldStandards/01_orig_GS/")
library(data.table)
si=fread("C://Projects/Sanger_OT_MVA/03_mva_draft/study_index.csv",data.table=F)
si=fread("study_index.csv",data.table=F)
si_s=si[si$has_sumstats==TRUE,]
l=table(si$trait_efos)
l
table(l==1)
table(l==0)
table(l==0)
table(l==1)
table(l==2)
table(l==3)
table(l>3)
hist(l)
hist(l[l>1],n=20)
hist(l[l>2],n=20)
hist(l[l>3],n=20)
max(l)
si$trait_efos
l
max(l)
l[l==7234]
si[si$trait_efos=="['EFO_0007937']",]
dim(si)
l=table(si_s$trait_efos)
table(l==0)
table(l==1)
l=table(si_s$trait_efos)
table(l==0)
table(l==1)
table(l==2)
table(l==3)
table(l>3)
hist(l[l>3],n=20)
hist(l[l>1],n=20)
hist(l[l>1],n=30)
max(l)
l[l==945]
hist(l[l>1 $ names(l)!="[]"],n=30)
hist(l[l>1 & names(l)!="[]"],n=30)
max(l[l>1 & names(l)!="[]"])
l[l==477]
problematic_efos=c("EFO_0007010","[]")
hist(l[l>1 & names(l)!%in%problematic_efos],n=30)
hist(l[l>1 & !names(l)%in%problematic_efos],n=30)
problematic_efos=c("EFO_0007010","[]")
hist(l[l>1 & !names(l)%in%problematic_efos],n=30)
max(l[l>1 & !names(l)%in%problematic_efos])
l[l==477]
problematic_efos=c("['EFO_0007010'] ","[]")
hist(l[l>1 & !names(l)%in%problematic_efos],n=30)
max(l[l>1 & !names(l)%in%problematic_efos])
problematic_efos=c("['EFO_0007010'] ","[]")
hist(l[l>1 & !names(l)%in%problematic_efos],n=30)
max(l[l>1 & !names(l)%in%problematic_efos])
problematic_efos=c("['EFO_0007010']","[]")
hist(l[l>1 & !names(l)%in%problematic_efos],n=30)
max(l[l>1 & !names(l)%in%problematic_efos])
l[l==433]
l[l==430]
l[l>100]
l[l>50]
problematic_efos=c(names(l[l>50]),"[]")
hist(l[l>1 & !names(l)%in%problematic_efos],n=30)
max(l[l>1 & !names(l)%in%problematic_efos])
setwd("~/Projects/Sanger_OT_MVA/05_descriptives/")
library(data.table)
si=fread("20230518_study_index.csv",data.table=F)
View(si)
si_s=si[si$has_sumstats==TRUE,]
l=table(si_s$trait_efos)
View(si_s)
si_sne=si_s[si_s$trait_efos!="[]",]
nrow(si_s)-nrow(si_sne)
l=table(si_sne$trait_efos)
table(l==0)
length(l)
table(l==1)
table(l>2)
table(l>1&l<=50)
table(l>50)
l=table(si_sne$trait_efos)
length(l)
table(l==1)
table(l==2)
table(l>2)
table(l>1&l<=50)
table(l>50)
names(l)[l>50]
l1=l[l>1 & l<=50]
length(l1)
problematic_efos=names(l)[l>50]
table(si_sne$trait_efos%in%problematic_efos)
l1=l[l>1 & l<=50]
length(l1)
l1=l[l>1 & l<=50]
length(l1)
table(si_sne$trait_efos%in%names(l1))
hist(l1,n=30)
hist(l1,n=30,density = 1)
hist(l1,n=30,density = 10)
hist(l1,n=30)
hist(l1,n=20)
hist(l1,n=10)
hist(l1,n=30)
hist(l1,n=30,xlim = c(1,50))
hist(l1,n=30,xlim = c(1,50),main="Histogram of numbers of traiits with the same EFO")
hist(l1,n=30,xlim = c(1,50),main="Histogram of number of traits with the same EFO")
hist(l1,n=30,xlim = c(1,50),main="Histogram of number of traits with the same EFO",xlab="Number of traits with the same EFO")
summary(l1)
summary(as.numeric(l1))
table(l>40)
table(l>30)
table(l>20)
table(l>30)
#FALSE  TRUE
#1714  1116
table(l>30)
names(l)[l>30]
problematic_efos=names(l)[l>30]
table(si_sne$trait_efos%in%problematic_efos)
l1=l[l>1 & l<=30]
length(l1)
table(si_sne$trait_efos%in%names(l1))
summary(as.numeric(l1))
table(si_sne$trait_efos%in%names(l1))
hist(l1,n=30,xlim = c(1,30),main="Histogram of number of traits with the same EFO",xlab="Number of traits with the same EFO")
setwd("~/Projects/Sanger_OT_GoldStandards/03_GS_old/")
library(data.table)
GS=fread("GS_old.csv",data.table=F)
ind=which(GS$gold_standard_status==1 & GS$gs_confidence%in%c("High","Medium"))
GS_pos=GS[ind,]
si=fread("~/Projects/Sanger_OT_MVA/05_descriptives/20230518_study_index.csv",data.table=F)
si=fread("~/Projects/Sanger_OT_MVA/05_descriptives/20230518_study_index.csv",data.table=F)
ind=match(GS$study_id,si$study_id)
table(si$study_id[ind]==GS$study_id)
GS$has_sumstats==si$has_sumstats[ind]
si=fread("~/Projects/Sanger_OT_MVA/05_descriptives/20230518_study_index.csv",data.table=F)
ind=match(GS$study_id,si$study_id)
table(si$study_id[ind]==GS$study_id)
GS$has_sumstats=si$has_sumstats[ind]
ind=which(GS$gold_standard_status==1 & GS$gs_confidence%in%c("High","Medium"))
GS_pos=GS[ind,]
table(GS$has_sumstats)
table(is.na(GS$has_sumstats))
GS_pos_ss=GS_pos[GS_pos$has_sumstats=="TRUE",]
ids=lengrth(unique(GS_pos_ss$study_id))
length(unique(GS_pos_ss$study_id))
View(GS_pos_ss)
colnames(GS_pos_ss)
GS_pos=GS_pos[,c(1:6,69:73)]
View(GS_pos)
ind=which(GS$gold_standard_status==1 & GS$gs_confidence%in%c("High","Medium"))
GS_pos=GS[ind,]
GS_pos=GS_pos[,c(1:6,69:73,52)]
View(GS_pos)
fwrite(x=GS_pos,file="GS_positives.csv")
GS_pos_ss=GS_pos[GS_pos$has_sumstats=="TRUE",]
length(unique(GS_pos_ss$study_id))
fwrite(x=unique(GS_pos_ss$study_id),file="list_study_ids_with_ss_GS_positives.csv")
y=cbind(unique(GS_pos_ss$study_id))
y
fwrite(x=y,file="list_study_ids_with_ss_GS_positives.csv",header=F)
fwrite(x=y,file="list_study_ids_with_ss_GS_positives.csv",col.names==F)
fwrite(x=y,file="list_study_ids_with_ss_GS_positives.csv",colnames==F)
t
y
fwrite(x=y,file="list_study_ids_with_ss_GS_positives.csv",colnames=F)
fwrite(x=y,file="list_study_ids_with_ss_GS_positives.csv",col.names=F)
GS_pos_ss=GS_pos[GS_pos$has_sumstats=="TRUE",]
GS_pos_ss=GS_pos_ss[,c(1:6,69:73,52)]
ind=which(GS$gold_standard_status==1 & GS$gs_confidence%in%c("High","Medium"))
GS_pos=GS[ind,]
GS_pos=GS_pos[,c(1:6,69:73,52)]
fwrite(x=GS_pos,file="GS_positives.csv")
GS_pos_ss=GS_pos[GS_pos$has_sumstats=="TRUE",]
fwrite(x=GS_pos_ss,file="GS_positives_ss.csv")
